# –í–≤–æ–¥–Ω–∞—è.

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç 3 –∫–ª–∞—Å—Å–∞, –ø—Ä–∏–º–µ–Ω—è—é—â–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω –§–∞—Å–∞–¥,  
–¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ php —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ cURL.

–¶–µ–ª—å: —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –∏ –ª—ë–≥–∫–∏–π –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø–∞–∫–µ—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–Ω—ã—Ö API –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ.

–Ø –∑–Ω–∞—é –ø—Ä–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∫–∞–∫: [Guzzle](https://github.com/guzzle/guzzle), [Client](https://github.com/yiisoft/yii2-httpclient) _(–≤ –º–æ—ë–º –ª—é–±–∏–º–æ–º Yii2)_, –Ω–æ —Ö–æ—Ç–µ–ª–æ—Å—å –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é.
–ë–µ–∑ "–ª–∏—à–Ω–∏—Ö" –¥–∞–Ω–Ω—ã—Ö, –≤—ã–∑–æ–≤–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ - —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ. –†–∞–∑—É–º–µ–µ—Ç—Å—è, —ç—Ç–æ –Ω–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç, –∞ –ø—Ä–æ—Å—Ç–æ –ø–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å —á—Ç–æ-—Ç–æ —Å–≤–æ—ë.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
 - php 8.0
 - ext cURL
 - ext JSON

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞.

### Git

–í —Ñ–∞–π–ª –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ `composer.json` –¥–æ–±–∞–≤—å—Ç–µ:  
 –≤ —Ä–∞–∑–¥–µ–ª `require`  —Å—Ç—Ä–æ–∫—É `"andy87/knockknock": "dev-main"`  
 –≤ —Ä–∞–∑–¥–µ–ª `repositories`  
```
{
    "type": "vcs",
    "url": "https://github.com/andy87/KnockKnock"
}
```
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É: `composer update`.  
–í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–∏–¥—ë—Ç—Å—è —Ç–∞–∫ –∂–µ –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–µ–Ω—å –¥–∞–Ω–Ω—ã—Ö `composer.json`  
`"minimum-stability": "dev"`

### Composer.

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ [composer](https://getcomposer.org/download/)

–õ–∏–±–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ

`composer require --prefer-dist andy87/KnockKnock`  
`php composer.phar require --prefer-dist andy87/KnockKnock`

–õ–∏–±–æ –¥–æ–±–∞–≤—å—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª `require` –≤–∞—à–µ–≥–æ `composer.json` —Ñ–∞–π–ª–∞ —Å—Ç—Ä–æ–∫—É

`"yiisoft/yii2-httpclient": "~2.0.0"`

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É `php composer.phar update` –ª–∏–±–æ `composer update`

___

# KnockKnock.

<p style="text-align: center"><img src="assets/docs/KnockKnockLogo_256.png" style="width:164px; height: auto" alt="KnockKnock php curl facade"/></p>

## –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å: 
_use [andy87\knock_knock\core\KnockKnock](src/core/KnockKnock.php);_  

PHP –§–∞—Å–∞–¥\–ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ ext cURL

–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏/—Ñ–∏—á–∏:
 - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
   - —Å–º. `–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç`
 - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
   - —Å–º. `–°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π`
 - –¥–æ—Å—Ç—É–ø–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Singleton
 - –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è
 - –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏

### –í–ê–ñ–ù–´–ô –ú–û–ú–ï–ù–¢!
`CURL_OPTIONS` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—É—Å—Ç—ã–µ! –í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–¥–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∞–ª–∏–¥–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.  
–°–º. –ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ.

–í –∫–ª–∞—Å—Å–∞—Ö –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç—Ç–µ—Ä—ã –∏ –≥–µ—Ç—Ç–µ—Ä—ã.

## –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞/—ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞ –∏ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ù–∞—Ç–∏–≤–Ω—ã–π
```php
$knockKnock = new KnockKnock( $_ENV['API_HOST'],[
     KnockRequestInterface::SETUP_CURL_OPTIONS => [
        CURLOPT_HEADER => false,
        CURLOPT_RETURNTRANSFER => true
    ]
]);
```

### Singleton
```php
$knockKnock = KnockKnock::getInstance( $_ENV['API_HOST'],[
        KnockRequest::SETUP_PROTOCO => KnockRequest::PROTOCOL_HTTP,
        KnockRequest::SETUP_CONTENT_TYPE => KnockRequest::CONTENT_TYPE_JSON,
    ])
    ->disableSSL();
```
–û–±–∞ –≤—ã–∑–æ–≤–∞ –≤–µ—Ä–Ω—É—Ç –æ–±—ä–µ–∫—Ç/—ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ `KnockKnock` –∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –Ω–∞ –≤—Ö–æ–¥ –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:
- `string $host` - —Ö–æ—Å—Ç
- `array $knockKnockConfig` - –º–∞—Å—Å–∏–≤ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏, –∫–ª—é—á–∞–º–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —è–≤–ª—è—é—Ç—Å—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∫–ª–∞—Å—Å–∞ `KnockRequest` –∏–º–µ—é—â–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å `SETUP_`.  
#### –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç:
- `SETUP_PROTOCOL`
- `SETUP_HOST`
- `SETUP_URL`
- `SETUP_METHOD`
- `SETUP_HEADERS`
- `SETUP_CONTENT_TYPE`
- `SETUP_DATA`
- `SETUP_CURL_OPTIONS`
- `SETUP_CURL_INFO`


## –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π

### –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
- –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ knockKnock
- –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
- –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞
- –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–≤–µ—Ç–∞
- –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞

##### –ü—Ä–∏–º–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
```php
$knockKnock->setupEventHandlers([
    KnockKnock::EVENT_AFTER_CONSTRUCT => fn( static $knockKnock ) => {
        // —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ knockKnock
    },
    KnockKnock::EVENT_CREATE_REQUEST => fn( static $knockKnock, KnockRequest $knockRequest ) => {
        // —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
    },
    KnockKnock::EVENT_BEFORE_SEND => fn(  static $knockKnock, KnockRequest $knockRequest ) => {
        // –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
    },
    KnockKnock::EVENT_CREATE_RESPONSE => fn( static $knockKnock, KnockResponse $knockResponse ) => {
        // —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–≤–µ—Ç–∞
    },
    KnockKnock::EVENT_AFTER_SEND => fn( static $knockKnock, KnockResponse $knockResponse ) => {
        // –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
    }
]);
```
–ü–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç - –∫–ª—é—á —Å–æ–±—ã—Ç–∏—è, –≤—Ç–æ—Ä–æ–π - callback —Ñ—É–Ω–∫—Ü–∏—è.

–í—Å–µ callback —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –ø–µ—Ä–≤—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –æ–±—ä–µ–∫—Ç/—ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ `KnockKnock`.  
–í—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –æ–±—ä–µ–∫—Ç/—ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ–±—ã—Ç–∏—è:
- `KnockRequest` - –¥–ª—è —Å–æ–±—ã—Ç–∏–π `EVENT_CREATE_REQUEST`, `EVENT_BEFORE_SEND`
- `KnockResponse` - –¥–ª—è —Å–æ–±—ã—Ç–∏–π `EVENT_CREATE_RESPONSE`, `EVENT_AFTER_SEND`

 <p style="text-align:center"> - - - - - </p>

# –ó–∞–ø—Ä–æ—Å.
_use [andy87\knock_knock\core\KnockRequest](src/core/KnockRequest.php);_  

–ù–∞—Ç–∏–≤–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ / —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
```php
$knockRequest = new KnockRequest( 'info/me', [
    KnockRequest::METHOD => LibKnockMethod::POST,
    KnockRequest::DATA => [ 'client_id' => 34 ],
    KnockRequest::HEADERS => [ 'api-secret-key' => $_ENV['API_SECRET_KEY'] ],
    KnockRequest::CURL_OPTIONS => [ CURLOPT_TIMEOUT => 10 ],
    KnockRequest::CURL_INFO => [
        CURLINFO_CONTENT_TYPE,
        CURLINFO_HEADER_SIZE,
        CURLINFO_TOTAL_TIME
    ],
    KnockRequest::CONTENT_TYPE => LibKnockContentType::FORM_DATA,
]);
```

–î–æ—Å—Ç—É–ø–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ - —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ —Ñ–∞—Å–∞–¥–∞ (—Å –≤—ã–∑–æ–≤–æ–º callback —Ñ—É–Ω–∫—Ü–∏–∏)
```php
$knockRequest = $knockKnock->constructKnockRequest( 'info/me', [
    KnockRequest::METHOD => LibKnockMethod::POST,
    KnockRequest::DATA => [ 'client_id' => 45 ],
    KnockRequest::HEADERS => [ 'api-secret-key' => $_ENV['API_SECRET_KEY'] ],
    KnockRequest::CURL_OPTIONS => [ CURLOPT_TIMEOUT => 10 ],
    KnockRequest::CURL_INFO => [
        CURLINFO_CONTENT_TYPE,
        CURLINFO_HEADER_SIZE,
        CURLINFO_TOTAL_TIME
    ],
    KnockRequest::CONTENT_TYPE => LibKnockContentType::FORM_DATA,
]);
```
`constructKnockRequest( string $url, array $knockRequestConfig = [] ): KnockRequest`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ/–ò–∑–º–µ–Ω–µ–Ω–∏–µ/–ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ (set/get)

–¢–∞–±–ª–∏—Ü–∞ set/get –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –∑–∞–ø—Ä–æ—Å–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä        | –°–µ—Ç—Ç–µ—Ä                                | –ì–µ—Ç—Ç–µ—Ä                   | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è                                                                                                                                                                    |
|-----------------|---------------------------------------|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| –ü—Ä–æ—Ç–æ–∫–æ–ª        | setProtocol( string $protocol )       | getProtocol(): string    | <a href="https://curl.se/docs/protdocs.html" target="_blank">–ø—Ä–æ—Ç–æ–∫–æ–ª—ã</a>                                                                                                    |
| –•–æ—Å—Ç            | setHost( string $host )               | getHost(): string        | ---                                                                                                                                                                           |
| Endpoint        | setEndpoint( string $url )            | getEndpoint(): string    | ---                                                                                                                                                                           |
| –ú–µ—Ç–æ–¥           | setMethod( string $method )           | getMethod(): string      | <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods" target="_blank">–º–µ—Ç–æ–¥—ã</a>                                                                                |
| –ó–∞–≥–æ–ª–æ–≤–∫–∏       | setHeaders( array $headers )          | getHeaders(): array      | <a href="https://ru.wikipedia.org/wiki/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%B7%D0%B0%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BA%D0%BE%D0%B2_HTTP" target="_blank">–∑–∞–≥–æ–ª–æ–≤–∫–∏</a>  |
| –¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞    | setContentType( string $contentType ) | getContentType(): string | <a href="https://ru.wikipedia.org/wiki/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_MIME-%D1%82%D0%B8%D0%BF%D0%BE%D0%B2" target="_blank">–¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞</a>                             |
| –î–∞–Ω–Ω—ã–µ          | setData( mixed $data )                | getData(): mixed         | ---                                                                                                                                                                           |
| –û–ø—Ü–∏–∏ cURL      | setCurlOptions( array $curlOptions )  | getCurlOptions(): array  | <a href="https://www.php.net/manual/ru/function.curl-setopt.php" target="_blank">–û–ø—Ü–∏–∏ cURL</a>                                                                               |
| –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è cURL | setCurlInfo( array $curlInfo )        | getCurlInfo(): array     | <a href="https://www.php.net/manual/ru/function.curl-getinfo.php" target="_blank">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è cURL</a>                                                                         |

```php
$knockRequest = $knockKnock->constructKnockRequest('info/me');

$knockRequest->setMethod( LibKnockMethod::GET );
$knockRequest->setData(['client_id' => 67]);
$knockRequest->setHeaders(['api-secret-key' => 'secretKey67']);
$knockRequest->setCurlOptions([
    CURLOPT_TIMEOUT => 10,
    CURLOPT_RETURNTRANSFER => true
]);
$knockRequest->setCurlInfo([
    CURLINFO_CONTENT_TYPE,
    CURLINFO_HEADER_SIZE,
    CURLINFO_TOTAL_TIME
]);
$knockRequest->setContentType( LibKnockContentType::JSON );

$protocol = $knockRequest->getPrococol(); // String
$host = $knockRequest->getHost(); // String
// ... –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –¥—Ä—É–≥–∏–µ –ø–æ–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –∑–∞–ø—Ä–æ—Å–∞
```

### –ú–∏–∫—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø—Ä–æ—Å, –Ω–∞ –æ—Å–Ω–æ–≤–µ —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –ø–µ—Ä–µ–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
```php
$knockKnock->setupRequest( $knockRequest, [
    KnockRequest::HOST => $_ENV['API_HOST'],
    KnockKnock::HEADERS => [
        'api-secret' => $_ENV['API_SECRET_KEY']
    ],
]);
```
`setupRequest( KnockRequest $knockRequest, array $options = [] ): self`

 <p style="text-align:center"> - - - - - </p>

# –û—Ç–≤–µ—Ç.
_use [andy87\knock_knock\core\KnockResponse](src/core/KnockResponse.php);_  

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `KnockResponse` —Å –≤—ã–∑–æ–≤–æ–º callback —Ñ—É–Ω–∫—Ü–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞  
```php
$knockResponse = $knockKnock->constructKnockResponse([
    KnockResponse::CONTENT => [
        'id' => 806034,
        'name' => 'and_y87'
    ],
    KnockResponse::HTTP_CODE => curl_getinfo( $ch, CURLINFO_HTTP_CODE ),
], $knockRequest );
```
`constructKnockResponse( array $KnockResponseParams, ?KnockRequest $knockRequest = null ): KnockResponse`  
ReadOnly —Å–≤–æ–π—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–∞:
 - content
 - httpCode
 - request
 - curlOptions
 - curlInfo

## KnockResponse: –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞

–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å, –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –∏ –≤—ã–∑–≤–∞—Ç—å –≤—Å–µ callback —Ñ—É–Ω–∫—Ü–∏–∏, –µ—Å–ª–∏ –æ–Ω–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
```php
$knockKnock->setupRequest( $knockRequest );
$knockResponse = $knockKnock->send();
```
`send( array $kafeResponse = [] ): KnockResponse`
–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç/—ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ `KnockResponse`

–ü—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞ - —Ü–µ–ø–æ—á–∫–æ–π –≤—ã–∑–æ–≤–æ–≤ (—Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ - –±–æ–ª–µ–µ –∫—Ä–∞—Å–∏–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)
```php
$knockResponse = $knockKnock->setRequest( $knockRequest )->send(); // return KnockResponse

$content = $knockResponse->content;
```

## –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å —Ñ—ç–π–∫–æ–≤—ã–º –æ—Ç–≤–µ—Ç–æ–º

–¶–µ–ø–æ—á–∫–∞ –≤—ã–∑–æ–≤–æ–≤, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –∏ –≤—ã–∑—ã–≤–∞–µ—Ç callback —Ñ—É–Ω–∫—Ü–∏—é, –µ—Å–ª–∏ –æ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
```php
// –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
$fakeResponse = [
    KnockResponse::HTTP_CODE => 200,
    KnockResponse::CONTENT => [
        'id' => 806034,
        'name' => 'and_y87'
    ],
];

$knockResponse = $knockKnock->setupRequest( $knockRequest )->send( $fakeResponse );
```
–æ–±—ä–µ–∫—Ç `$knockResponse` –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–µ `$fakeResponse`


## –î–∞–Ω–Ω—ã–µ –≤ –æ—Ç–≤–µ—Ç–µ

–í —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç `KnockResponse` —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.
```php
$knockResponse = $knockKnock->setupRequest( $knockRequest )->send();

$knockResponse
    ->setHttpCode(200)
    ->setContent('{"id" => 8060345, "nickName" => "and_y87"}');
```
**–í–Ω–∏–º–∞–Ω–∏–µ!** –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –æ–±—ä–µ–∫—Ç–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–¥–∞—Ç—å –∏—Ö –Ω–µ–ª—å–∑—è –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `Exception`.  
–í —Å–ª—É—á–∞–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ `replace( string $key, mixed $value )` —Å–º. –¥–∞–ª–µ–µ

### –ü–æ–¥–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã—Ö
```php
$knockResponse = $knockKnock->setupRequest( $knockRequest )->send();

$knockResponse
    ->replace( KnockResponse::HTTP_CODE, 200 )
    ->replace( KnockResponse::CONTENT, '{"id" => 8060345, "nickName" => "and_y87"}' );
```

## –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –æ—Ç–≤–µ—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–ø—Ä–æ—Å–µ

–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
```php
$knockRequest = $knockResponse->request
```
`request` - readOnly —Å–≤–æ–π—Å—Ç–≤–æ

–ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤ –∑–Ω–∞—á–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
```php
// –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ü–∏–π –∑–∞–ø—Ä–æ—Å–∞ (  KnockRequest::CURL_OPTIONS )
$curlOptions =  $knockResponse->get( KnockResponse::CURL_OPTIONS ); // return array

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–ø—Ä–æ—Å–µ ( KnockRequest::CURL_INFO )
$curlInfo =  $knockResponse->get( KnockResponse::CURL_INFO ); // return array

```

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å

### SSL
–í –æ–±—ä–µ–∫—Ç–∞—Ö `KnockKnock` & `KnockRequest` –∏–º–µ–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è SSL –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏.  

–í `curlOptions` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á `CURLOPT_SSL_VERIFYPEER`.

`KnockKnock` - –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```php
$knockKnock->disableSSL();
$knockKnock->enableSSL();
```

`KnockRequest` - –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
```php
$knockRequest->disableSSL();
$knockRequest->enableSSL();

```

___

# –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞

### [KnockKnockOctopus](docs/KnockKnock/KnockKnockOctopus.md)

<p style="text-align:center"><a href="docs/KnockKnock/KnockKnockOctopus.md"><img src="assets/docs/KnockKnockOctopus_320.png" style="width:200px; height: auto" alt="KnockKnock php curl facade"/></a></p>

–ö–ª–∞—Å—Å —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –ø—Ä–æ—Å—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

#### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã.

| get() | post() | put() | patch() | delete() | head() | options() | trace() |
|-------|--------|-------|---------|----------|--------|-----------|---------|

#### –ö–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞:
| –ê—Ä–≥—É–º–µ–Ω—Ç  |   –¢–∏–ø   | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π  | –û–ø–∏—Å–∞–Ω–∏–µ                       |
|:----------|:-------:|:-------------:|:-------------------------------|
| $endpoint | string  |      –î–∞       | URL –∑–∞–ø—Ä–æ—Å–∞ (–±–µ–∑ —Ö–æ—Å—Ç–∞)        |
| $params   |  array  |      –ù–µ—Ç      | –î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞  |
_P.S. host –∑–∞–¥–∞—ë—Ç—Å—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ_

#### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```php
//GET –∑–∞–ø—Ä–æ—Å
$knockKnockOctopus->get( '/profile', [ 'id' => 806034 ] );

//POST –∑–∞–ø—Ä–æ—Å
$knockKnockOctopus->post( '/new', [ 
    'name' => '–ù–æ–≤–∞—è –Ω–æ–≤–æ—Å—Ç—å',
    'content' => '–¢–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏' 
]);
```
 <p style="text-align:center"> - - - - - </p>

### [KnockKnockSecurity](docs/KnockKnock/KnockKnockSecurity.md)

<p style="text-align: center"><a href="docs/KnockKnock/KnockKnockSecurity.md"><img src="assets/docs/KnockKnockSecurity_280.png" style="width:auto; height: 128px" alt="KnockKnock php curl facade"/></a></p>

–ö–ª–∞—Å—Å —Å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

___

# Custom —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

Custom —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ë–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞, –∫ –ø—Ä–∏–º–µ—Ä—É —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—â–∏–º "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º"
```php
class KnockKnockYandex extends KnockKnock
{
    private const LOGGER = 'logger';


    private string $host = 'https://api.yandex.ru/'

    private string $contentType = LibKnockContentType::JSON

    private YandexLogger $logger;



    /**
     * @return void
     */
    public function init(): void
    {
        $this->setupYandexLoggerEventHandlers();
    }
    
    /**
     * @param array $callbacks
     * 
     * @return self
     */
    private function setupYandexLoggerEventHandlers( array $callbacks ): self
    {
        $this->on( self::AFTER_CREATE_REQUEST, fn( KnockRequest $knockRequest ) => 
        {
            $logData = $this->getLogDataByRequest( $knockRequest );

            $this->addYandexLog( $logData );
        };

        $this->on(self::EVENT_AFTER_SEND, fn( KnockResponse $knockResponse ) => 
        {
            $logData = $this->getLogDataByRequest( $knockResponse->request );

            $this->addYandexLog( $logData );
        };
    }

    /**
      * @param KnockRequest $knockRequest
      * 
      * @return array
      */
    private function getLogDataByRequest( KnockRequest $knockRequest ): array
    {
        return $knockRequest->getParams();
    }

    /**
     * @param array $logData
     * 
     * @return void
     */
    private function addYandexLog( array $logData ): bool
    {
        return $logger->log( $logData );
    }
}

```
### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è custom —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
```php

$knockKnockYandex = KnockKnockYandex::getInstan—Åe( $_ENV['API_HOST'], [
    KnockKnockYandex::LOGGER => new YandexLogger(),
]);

$knockResponse = $knockKnockYandex->setupRequest( 'profile', [ 
    KnockRequest::METHOD => LibKnockMethod::PATCH,
    KnockRequest::DATA => [ 'city' => 'Moscow' ],
]); // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ `afterCreateRequest`

$knockResponse = $knockKnockYandex->send(); // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ `afterSend`

```

## –õ–∏—Ü–µ–Ω–∑–∏—è

https://github.com/andy87/KnockKnock –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π CC BY-SA 4.0  
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ http://creativecommons.org/licenses/by-sa/4.0/  
–î–ª—è –Ω–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ - FREE  
–î–ª—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è -  —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∞–≤—Ç–æ—Ä—Å—Ç–≤–∞  

---
> ## üöß –ê–ª—å—Ñ–∞ –≤–µ—Ä—Å–∏—è
> –í–æ–∑–º–æ–∂–Ω–æ –Ω–∞–ª–∏—á–∏–µ –±–∞–≥–æ–≤
---
